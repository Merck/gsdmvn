<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Basic group sequential design computations extended.">
<title>Group sequential design with non-constant effect â€¢ gsdmvn</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Group sequential design with non-constant effect">
<meta property="og:description" content="Basic group sequential design computations extended.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">gsdmvn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/DesignWithAverageHazardRatio.html">Design Using Average Hazard Ratio</a>
    <a class="dropdown-item" href="articles/DesignWithSpending.html">Trial design with spending under NPH</a>
    <a class="dropdown-item" href="articles/NPEbackground.html">Non-Proportional Effect Size in Group Sequential Design</a>
    <a class="dropdown-item" href="articles/NPEbounds.html">Computing Bounds Under Non-Constant Treatment Effect</a>
    <a class="dropdown-item" href="articles/PowerEvaluationWithSpending.html">Power Evaluation with Spending bounds</a>
    <a class="dropdown-item" href="articles/QuickStart.html">Quick Start for NPH Sample Size and Power</a>
    <a class="dropdown-item" href="articles/SpendingTimeExamples.html">Spending Time Examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Merck/gsdmvn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="gsdmvn">gsdmvn<a class="anchor" aria-label="anchor" href="#gsdmvn"></a>
</h1></div>
<!-- badges: start -->
<p>The goal of <strong>gsdmvn</strong> is to enable fixed or group sequential design under non-proportional hazards. Piecewise constant enrollment, failure rates and dropout rates for a stratified population are available to enable highly flexible enrollment, time-to-event and time-to-dropout assumptions. Substantial flexibility on top of what is in the gsDesign package is intended for selecting boundaries. While this work is in progress, substantial capabilities have been enabled. Comments on usability and features are encouraged as this is a development version of the package.</p>
<p>The goal of gsdmvn is to enable group sequential trial design for time-to-event endpoints under non-proportional hazards assumptions. The package is still maturing; as the package functions become more stable, they will likely be included in the <a href="https://github.com/Merck/gsDesign2" class="external-link">gsDesign2</a> package.</p>
<div class="section level2">
<h2 id="branch-specification">Branch specification<a class="anchor" aria-label="anchor" href="#branch-specification"></a>
</h2>
<ul>
<li>The <code>development</code> branch includes all work under development.</li>
<li>The <code>table_bound</code> branch is branched from the <code>development</code> branch, and it targets to get the outputs of <code>gd_design_ahr()</code>, <code><a href="reference/gs_power_ahr.html">gs_power_ahr()</a></code>,<code>gs_desgin_wlr()</code>, etc., into a well-organized form.</li>
<li>The <code>update_futility_bound</code> branch is branched from the <code>development</code> branch, and it targets to develop code so one can update the futility bound.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>gsdmvn</code> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Merck/gsdmvn"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specifying-enrollment-and-failure-rates">Specifying enrollment and failure rates<a class="anchor" aria-label="anchor" href="#specifying-enrollment-and-failure-rates"></a>
</h2>
<p>This is a basic example which shows you how to solve a common problem. We assume there is a 4 month delay in treatment effect. Specifically, we assume a hazard ratio of 1 for 4 months and 0.6 thereafter. For this example we assume an exponential failure rate and low exponential dropout rate. The <code>enrollRates</code> specification indicates an expected enrollment duration of 12 months with exponential inter-arrival times.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://merck.github.io/gsdmvn/">gsdmvn</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesign/" class="external-link">gsDesign</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://merck.github.io/gsDesign2/" class="external-link">gsDesign2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>

<span class="co">## basic example code</span>

<span class="co">## Constant enrollment over 12 months</span>
<span class="co">## rate will be adjusted later by gsDesignNPH to get sample size</span>
<span class="va">enrollRates</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, duration <span class="op">=</span> <span class="fl">12</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co">## 12 month median exponential failure rate in control</span>
<span class="co">## 4 month delay in effect with HR=0.6 after</span>
<span class="co">## Low exponential dropout rate</span>
<span class="va">medianSurv</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="va">failRates</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  Stratum <span class="op">=</span> <span class="st">"All"</span>,
  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="cn">Inf</span><span class="op">)</span>,
  failRate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">medianSurv</span>,
  hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.6</span><span class="op">)</span>,
  dropoutRate <span class="op">=</span> <span class="fl">.001</span>
<span class="op">)</span></code></pre></div>
<p>The resulting failure rate specification is the following table. As many rows and strata as needed can be specified to approximate whatever patterns you wish.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">failRates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Stratum</th>
<th align="right">duration</th>
<th align="right">failRate</th>
<th align="right">hr</th>
<th align="right">dropoutRate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">All</td>
<td align="right">4</td>
<td align="right">0.0577623</td>
<td align="right">1.0</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">All</td>
<td align="right">Inf</td>
<td align="right">0.0577623</td>
<td align="right">0.6</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
<p>Computing a fixed sample size design with 2.5% one-sided Type I error and 90% power. We specify a trial duration of 36 months with <code>analysisTimes</code>. Since there is a single analysis, we specify an upper p-value bound of 0.025 with <code>upar = qnorm(0.975)</code>. There is no lower bound which is specified with <code>lpar = -Inf</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="reference/gs_design_ahr.html">gs_design_ahr</a></span><span class="op">(</span><span class="va">enrollRates</span>, <span class="va">failRates</span>, upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span>, lpar <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, IF <span class="op">=</span> <span class="fl">1</span>, analysisTimes <span class="op">=</span> <span class="fl">36</span><span class="op">)</span></code></pre></div>
<p>The input enrollment rates are scaled to achieve power:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span><span class="op">$</span><span class="va">enrollRates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Stratum</th>
<th align="right">duration</th>
<th align="right">rate</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">All</td>
<td align="right">12</td>
<td align="right">35.05288</td>
</tr></tbody>
</table>
<p>The failure and dropout rates remain unchanged from what was input:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span><span class="op">$</span><span class="va">failRates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Stratum</th>
<th align="right">duration</th>
<th align="right">failRate</th>
<th align="right">hr</th>
<th align="right">dropoutRate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">All</td>
<td align="right">4</td>
<td align="right">0.0577623</td>
<td align="right">1.0</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">All</td>
<td align="right">Inf</td>
<td align="right">0.0577623</td>
<td align="right">0.6</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
<p>Finally, the expected analysis time is in <code>Time</code>, sample size <code>N</code>, events required <code>Events</code> and bound <code>Z</code> are in <code>design$bounds</code>. Note that <code>AHR</code> is the average hazard ratio used to calculate the targeted event counts. The natural parameter (<code>log(AHR)</code>) is in theta and corresponding statistical information under the alternate hypothesis are in <code>info</code> and under the null hypothesis in <code>info0</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span><span class="op">$</span><span class="va">bounds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Analysis</th>
<th align="left">Bound</th>
<th align="right">Time</th>
<th align="right">N</th>
<th align="right">Events</th>
<th align="right">Z</th>
<th align="right">Probability</th>
<th align="right">AHR</th>
<th align="right">theta</th>
<th align="right">info</th>
<th align="right">info0</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1</td>
<td align="left">Upper</td>
<td align="right">36</td>
<td align="right">420.6346</td>
<td align="right">311.0028</td>
<td align="right">1.959964</td>
<td align="right">0.9</td>
<td align="right">0.6917244</td>
<td align="right">0.3685676</td>
<td align="right">76.74383</td>
<td align="right">77.75069</td>
</tr></tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Merck/gsdmvn/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Merck/gsdmvn/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing gsdmvn</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Keaven Anderson <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Merck/gsdmvn/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Merck/gsdmvn/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/Merck/gsdmvn?branch=main" class="external-link"><img src="https://codecov.io/gh/Merck/gsdmvn/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Keaven Anderson. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3. <br>Copyright Â© Merck Sharp &amp; Dohme Corp., a subsidiary of Merck &amp; Co., Inc., Kenilworth, NJ, USA.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><span></span></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Group sequential design computation with non-constant effect and information — gs_design_npe • gsdmvn</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Group sequential design computation with non-constant effect and information — gs_design_npe" />
<meta property="og:description" content="gs_design_npe() derives group sequential design size, bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses.
It allows a non-constant treatment effect over time, but also can be applied for the usual homogeneous effect size designs.
It requires treatment effect and proportionate statistical information at each analysis as well as a method of deriving bounds, such as spending.
The routine enables two things not available in the gsDesign package: 1) non-constant effect, 2) more flexibility in boundary selection.
For many applications, the non-proportional-hazards design function gs_design_nph() will be used; it calls this function.
Initial bound types supported are 1) spending bounds, 2) fixed bounds, and 3) Haybittle-Peto-like bounds.
The requirement is to have a boundary update method that can each bound without knowledge of future bounds.
As an example, bounds based on conditional power that require knowledge of all future bounds are not supported by this routine;
a more limited conditional power method will be demonstrated.
Boundary family designs Wang-Tsiatis designs including the original (non-spending-function-based) O'Brien-Fleming and Pocock designs
are not supported by gs_power_npe()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsdmvn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/DesignWithAverageHazardRatio.html">Design Using Average Hazard Ratio</a>
    </li>
    <li>
      <a href="../articles/DesignWithSpending.html">Trial design with spending under NPH</a>
    </li>
    <li>
      <a href="../articles/NPEbackground.html">Non-Proportional Effect Size in Group Sequential Design</a>
    </li>
    <li>
      <a href="../articles/NPEbounds.html">Computing Bounds Under Non-Constant Treatment Effect</a>
    </li>
    <li>
      <a href="../articles/PowerEvaluationWithSpending.html">Power Evaluation with Spending bounds</a>
    </li>
    <li>
      <a href="../articles/QuickStart.html">Quick Start for NPH Sample Size and Power</a>
    </li>
    <li>
      <a href="../articles/SpendingTimeExamples.html">Spending Time Examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Group sequential design computation with non-constant effect and information</h1>
    
    <div class="hidden name"><code>gs_design_npe.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>gs_design_npe()</code> derives group sequential design size, bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses.
It allows a non-constant treatment effect over time, but also can be applied for the usual homogeneous effect size designs.
It requires treatment effect and proportionate statistical information at each analysis as well as a method of deriving bounds, such as spending.
The routine enables two things not available in the gsDesign package: 1) non-constant effect, 2) more flexibility in boundary selection.
For many applications, the non-proportional-hazards design function <code><a href='gs_design_nph.html'>gs_design_nph()</a></code> will be used; it calls this function.
Initial bound types supported are 1) spending bounds, 2) fixed bounds, and 3) Haybittle-Peto-like bounds.
The requirement is to have a boundary update method that can each bound without knowledge of future bounds.
As an example, bounds based on conditional power that require knowledge of all future bounds are not supported by this routine;
a more limited conditional power method will be demonstrated.
Boundary family designs Wang-Tsiatis designs including the original (non-spending-function-based) O'Brien-Fleming and Pocock designs
are not supported by <code><a href='gs_power_npe.html'>gs_power_npe()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>gs_design_npe</span><span class='op'>(</span>
  theta <span class='op'>=</span> <span class='fl'>0.1</span>,
  theta1 <span class='op'>=</span> <span class='cn'>NULL</span>,
  info <span class='op'>=</span> <span class='fl'>1</span>,
  info0 <span class='op'>=</span> <span class='cn'>NULL</span>,
  info1 <span class='op'>=</span> <span class='cn'>NULL</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.025</span>,
  beta <span class='op'>=</span> <span class='fl'>0.1</span>,
  binding <span class='op'>=</span> <span class='cn'>FALSE</span>,
  upper <span class='op'>=</span> <span class='va'>gs_b</span>,
  lower <span class='op'>=</span> <span class='va'>gs_b</span>,
  upar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>0.975</span><span class='op'>)</span>,
  lpar <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>,
  test_upper <span class='op'>=</span> <span class='cn'>TRUE</span>,
  test_lower <span class='op'>=</span> <span class='cn'>TRUE</span>,
  r <span class='op'>=</span> <span class='fl'>18</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-06</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>theta</th>
      <td><p>natural parameter for group sequential design representing expected incremental drift at all analyses;
used for power calculation</p></td>
    </tr>
    <tr>
      <th>theta1</th>
      <td><p>natural parameter used for lower bound spending; if <code>NULL</code>, this will be set to <code>theta</code>
which yields the usual beta-spending. If set to 0, spending is 2-sided under null hypothesis.</p></td>
    </tr>
    <tr>
      <th>info</th>
      <td><p>proportionate statistical information at all analyses for input <code>theta</code></p></td>
    </tr>
    <tr>
      <th>info0</th>
      <td><p>proportionate statistical information under null hypothesis, if different than alternative;
impacts null hypothesis bound calculation</p></td>
    </tr>
    <tr>
      <th>info1</th>
      <td><p>proportionate statistical information under alternate hypothesis;
impacts null hypothesis bound calculation</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>One-sided Type I error</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>Type II error</p></td>
    </tr>
    <tr>
      <th>binding</th>
      <td><p>indicator of whether futility bound is binding; default of FALSE is recommended</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>function to compute upper bound</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>function to compare lower bound</p></td>
    </tr>
    <tr>
      <th>upar</th>
      <td><p>parameter to pass to function provided in <code>upper</code></p></td>
    </tr>
    <tr>
      <th>lpar</th>
      <td><p>Parameter passed to function provided in <code>lower</code></p></td>
    </tr>
    <tr>
      <th>test_upper</th>
      <td><p>indicator of which analyses should include an upper (efficacy) bound; single value of TRUE (default) indicates all analyses;
otherwise, a logical vector of the same length as <code>info</code> should indicate which analyses will have an efficacy bound</p></td>
    </tr>
    <tr>
      <th>test_lower</th>
      <td><p>indicator of which analyses should include an lower bound; single value of TRUE (default) indicates all analyses;
single value FALSE indicated no lower bound; otherwise, a logical vector of the same length as <code>info</code> should indicate which analyses will have a
lower bound</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>Integer, at least 2; default of 18 recommended by Jennison and Turnbull</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance parameter for boundary convergence (on Z-scale)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>tibble</code> with columns Analysis, Bound, Z, Probability,  theta, info, info0</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The inputs <code>info</code> and <code>info0</code> should be vectors of the same length with increasing positive numbers.
The design returned will change these by some constant scale factor to ensure the design has power <code>1 - beta</code>.
The bound specifications in <code>upper, lower, upar, lpar</code> will be used to ensure Type I error and other boundary properties are as specified.</p>
    <h2 class="hasAnchor" id="specification"><a class="anchor" href="#specification"></a>Specification</h2>

    

<p>The contents of this section are shown in PDF user manual only.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Keaven Anderson <a href='mailto:keaven\_anderson@merck.'>keaven\_anderson@merck.</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>gsDesign</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='co'># Single analysis</span>
<span class='co'># Lachin book p 71 difference of proportions example</span>
<span class='va'>pc</span> <span class='op'>&lt;-</span> <span class='fl'>.28</span> <span class='co'># Control response rate</span>
<span class='va'>pe</span> <span class='op'>&lt;-</span> <span class='fl'>.40</span> <span class='co'># Experimental response rate</span>
<span class='va'>p0</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>pc</span> <span class='op'>+</span> <span class='va'>pe</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span> <span class='co'># Ave response rate under H0</span>
<span class='co'># Information per increment of 1 in sample size</span>
<span class='va'>info0</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>p0</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>p0</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>4</span><span class='op'>)</span>
<span class='va'>info1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>pc</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>pc</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='va'>pe</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>pe</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='co'># Result should round up to next even number = 652</span>
<span class='co'># Divide information needed under H1 by information per patient added</span>
<span class='fu'>gs_design_npe</span><span class='op'>(</span>theta <span class='op'>=</span> <span class='va'>pe</span> <span class='op'>-</span> <span class='va'>pc</span>, info <span class='op'>=</span> <span class='va'>info1</span>, info0 <span class='op'>=</span> <span class='va'>info0</span><span class='op'>)</span><span class='op'>$</span><span class='va'>info</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>info1</span>
</div><div class='output co'>#&gt; [1] 650.7984</div><div class='input'>
<span class='co'># Fixed bound</span>
<span class='va'>design</span> <span class='op'>&lt;-</span>
<span class='fu'>gs_design_npe</span><span class='op'>(</span>theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span><span class='op'>)</span>, info <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>80</span>, 
              info0 <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>80</span>, info1 <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>80</span>,
              upper <span class='op'>=</span> <span class='va'>gs_b</span>, upar <span class='op'>=</span> <span class='fu'>gsDesign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gsDesign/man/gsDesign.html'>gsDesign</a></span><span class='op'>(</span>k<span class='op'>=</span><span class='fl'>3</span>,sfu<span class='op'>=</span><span class='fu'>gsDesign</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span><span class='op'>)</span><span class='op'>$</span><span class='va'>upper</span><span class='op'>$</span><span class='va'>bound</span>,
              lower <span class='op'>=</span> <span class='va'>gs_b</span>, lpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>design</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 9</span>
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>        1 Upper  3.71     0.001<span style='text-decoration: underline;'>20</span>   0.1    0.1  45.6  45.6  45.6
#&gt; <span style='color: #BCBCBC;'>2</span>        2 Upper  2.51     0.273     0.2    0.2  91.1  91.1  91.1
#&gt; <span style='color: #BCBCBC;'>3</span>        3 Upper  1.99     0.900     0.3    0.3 137.  137.  137. 
#&gt; <span style='color: #BCBCBC;'>4</span>        1 Lower -<span style='color: #BB0000;'>1</span>        0.047<span style='text-decoration: underline;'>0</span>    0.1    0.1  45.6  45.6  45.6
#&gt; <span style='color: #BCBCBC;'>5</span>        2 Lower  0        0.061<span style='text-decoration: underline;'>9</span>    0.2    0.2  91.1  91.1  91.1
#&gt; <span style='color: #BCBCBC;'>6</span>        3 Lower  0        0.061<span style='text-decoration: underline;'>9</span>    0.3    0.3 137.  137.  137. </div><div class='input'>
<span class='co'># Same fixed bounds, null hypothesis</span>
<span class='fu'><a href='gs_power_npe.html'>gs_power_npe</a></span><span class='op'>(</span>theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>3</span><span class='op'>)</span>, info <span class='op'>=</span> <span class='va'>design</span><span class='op'>$</span><span class='va'>info0</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, 
            upar <span class='op'>=</span> <span class='va'>design</span><span class='op'>$</span><span class='va'>Z</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, lpar <span class='op'>=</span> <span class='va'>design</span><span class='op'>$</span><span class='va'>Z</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 9</span>
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>        1 Upper  3.71    0.000<span style='text-decoration: underline;'>104</span>     0      0  45.6  45.6  45.6
#&gt; <span style='color: #BCBCBC;'>2</span>        2 Upper  2.51    0.006<span style='text-decoration: underline;'>05</span>      0      0  91.1  91.1  91.1
#&gt; <span style='color: #BCBCBC;'>3</span>        3 Upper  1.99    0.024<span style='text-decoration: underline;'>9</span>       0      0 137.  137.  137. 
#&gt; <span style='color: #BCBCBC;'>4</span>        1 Lower -<span style='color: #BB0000;'>1</span>       0.159        0      0  45.6  45.6  45.6
#&gt; <span style='color: #BCBCBC;'>5</span>        2 Lower  0       0.513        0      0  91.1  91.1  91.1
#&gt; <span style='color: #BCBCBC;'>6</span>        3 Lower  0       0.606        0      0 137.  137.  137. </div><div class='input'>
<span class='co'># Same upper bound; this represents non-binding Type I error and will total 0.025</span>
<span class='fu'><a href='gs_power_npe.html'>gs_power_npe</a></span><span class='op'>(</span>theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>3</span><span class='op'>)</span>, info <span class='op'>=</span> <span class='va'>design</span><span class='op'>$</span><span class='va'>info0</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, 
             upar <span class='op'>=</span> <span class='va'>design</span><span class='op'>$</span><span class='va'>Z</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, lpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Bound</span><span class='op'>==</span><span class='st'>"Upper"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 3 × 9</span>
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>        1 Upper  3.71    0.000<span style='text-decoration: underline;'>104</span>     0      0  45.6  45.6  45.6
#&gt; <span style='color: #BCBCBC;'>2</span>        2 Upper  2.51    0.006<span style='text-decoration: underline;'>05</span>      0      0  91.1  91.1  91.1
#&gt; <span style='color: #BCBCBC;'>3</span>        3 Upper  1.99    0.025<span style='text-decoration: underline;'>0</span>       0      0 137.  137.  137. </div><div class='input'>
<span class='co'># Spending bound examples</span>

<span class='co'># Design with futility only at analysis 1; efficacy only at analyses 2, 3</span>
<span class='co'># Spending bound for efficacy; fixed bound for futility</span>
<span class='co'># NOTE: test_upper and test_lower DO NOT WORK with gs_b; must explicitly make bounds infinite</span>
<span class='co'># test_upper and test_lower DO WORK with gs_spending_bound</span>
<span class='va'>design</span> <span class='op'>&lt;-</span>
<span class='fu'>gs_design_npe</span><span class='op'>(</span>theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span><span class='op'>)</span>, info <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>40</span>, info0 <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>40</span>,
              upper <span class='op'>=</span> <span class='va'>gs_spending_bound</span>,
              upar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sf <span class='op'>=</span> <span class='fu'>gsDesign</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, total_spend <span class='op'>=</span> <span class='fl'>0.025</span>, 
                          param <span class='op'>=</span> <span class='cn'>NULL</span>, timing <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>,
              lower <span class='op'>=</span> <span class='va'>gs_b</span>, lpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>-</span><span class='cn'>Inf</span>, <span class='op'>-</span><span class='cn'>Inf</span><span class='op'>)</span>,
              test_upper <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>TRUE</span>, <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>design</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 9</span>
#&gt;   Analysis Bound       Z Probability theta theta1  info info0 info1
#&gt;      <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>        1 Upper  <span style='color: #BB0000;'>Inf</span>         0        0.1    0.1  44.6  44.6  44.6
#&gt; <span style='color: #BCBCBC;'>2</span>        2 Upper    2.51      0.267    0.2    0.2  89.1  89.1  89.1
#&gt; <span style='color: #BCBCBC;'>3</span>        3 Upper    1.99      0.900    0.3    0.3 134.  134.  134. 
#&gt; <span style='color: #BCBCBC;'>4</span>        1 Lower   -<span style='color: #BB0000;'>1</span>         0.047<span style='text-decoration: underline;'>7</span>   0.1    0.1  44.6  44.6  44.6
#&gt; <span style='color: #BCBCBC;'>5</span>        2 Lower -<span style='color: #BB0000;'>Inf</span>         0.047<span style='text-decoration: underline;'>7</span>   0.2    0.2  89.1  89.1  89.1
#&gt; <span style='color: #BCBCBC;'>6</span>        3 Lower -<span style='color: #BB0000;'>Inf</span>         0.047<span style='text-decoration: underline;'>7</span>   0.3    0.3 134.  134.  134. </div><div class='input'>
<span class='co'># Spending function bounds</span>
<span class='co'># 2-sided asymmetric bounds</span>
<span class='co'># Lower spending based on non-zero effect</span>
<span class='fu'>gs_design_npe</span><span class='op'>(</span>theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span><span class='op'>)</span>, info <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>40</span>,
             upper <span class='op'>=</span> <span class='va'>gs_spending_bound</span>,
             upar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sf <span class='op'>=</span> <span class='fu'>gsDesign</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, total_spend <span class='op'>=</span> <span class='fl'>0.025</span>, 
                         param <span class='op'>=</span> <span class='cn'>NULL</span>, timing <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>,
             lower <span class='op'>=</span> <span class='va'>gs_spending_bound</span>,
             lpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sf <span class='op'>=</span> <span class='fu'>gsDesign</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/gsDesign/man/sfHSD.html'>sfHSD</a></span>, total_spend <span class='op'>=</span> <span class='fl'>0.1</span>, 
                         param <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, timing <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 9</span>
#&gt;   Analysis Bound      Z Probability theta theta1  info info0 info1
#&gt;      <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>        1 Upper  3.71      0.001<span style='text-decoration: underline;'>14</span>   0.1    0.1  43.3  43.3  43.3
#&gt; <span style='color: #BCBCBC;'>2</span>        2 Upper  2.51      0.258     0.2    0.2  86.7  86.7  86.7
#&gt; <span style='color: #BCBCBC;'>3</span>        3 Upper  1.99      0.900     0.3    0.3 130.  130.  130. 
#&gt; <span style='color: #BCBCBC;'>4</span>        1 Lower -<span style='color: #BB0000;'>1.34</span>      0.023<span style='text-decoration: underline;'>0</span>    0.1    0.1  43.3  43.3  43.3
#&gt; <span style='color: #BCBCBC;'>5</span>        2 Lower  0.146     0.055<span style='text-decoration: underline;'>2</span>    0.2    0.2  86.7  86.7  86.7
#&gt; <span style='color: #BCBCBC;'>6</span>        3 Lower  1.99      0.100     0.3    0.3 130.  130.  130. </div><div class='input'>
<span class='co'># Two-sided symmetric spend, O'Brien-Fleming spending</span>
<span class='co'># Typically, 2-sided bounds are binding</span>
<span class='va'>xx</span> <span class='op'>&lt;-</span> <span class='fu'>gs_design_npe</span><span class='op'>(</span>theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span><span class='op'>)</span>, theta1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span>, info <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>40</span>,
                    binding <span class='op'>=</span> <span class='cn'>TRUE</span>,
                    upper <span class='op'>=</span> <span class='va'>gs_spending_bound</span>,
                    upar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sf <span class='op'>=</span> <span class='fu'>gsDesign</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, total_spend <span class='op'>=</span> <span class='fl'>0.025</span>, 
                                param <span class='op'>=</span> <span class='cn'>NULL</span>, timing <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>,
                    lower <span class='op'>=</span> <span class='va'>gs_spending_bound</span>,
                    lpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sf <span class='op'>=</span> <span class='fu'>gsDesign</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, total_spend <span class='op'>=</span> <span class='fl'>0.025</span>, 
                                param <span class='op'>=</span> <span class='cn'>NULL</span>, timing <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>xx</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 9</span>
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>        1 Upper  3.71  0.001<span style='text-decoration: underline;'>03</span>      0.1      0  39.7  39.7  39.7
#&gt; <span style='color: #BCBCBC;'>2</span>        2 Upper  2.51  0.233        0.2      0  79.4  79.4  79.4
#&gt; <span style='color: #BCBCBC;'>3</span>        3 Upper  1.99  0.900        0.3      0 119.  119.  119. 
#&gt; <span style='color: #BCBCBC;'>4</span>        1 Lower -<span style='color: #BB0000;'>3.71</span>  0.000<span style='text-decoration: underline;'>007</span>11   0.1      0  39.7  39.7  39.7
#&gt; <span style='color: #BCBCBC;'>5</span>        2 Lower -<span style='color: #BB0000;'>2.51</span>  0.000<span style='text-decoration: underline;'>015</span>4    0.2      0  79.4  79.4  79.4
#&gt; <span style='color: #BCBCBC;'>6</span>        3 Lower -<span style='color: #BB0000;'>1.99</span>  0.000<span style='text-decoration: underline;'>015</span>4    0.3      0 119.  119.  119. </div><div class='input'>
<span class='co'># Re-use these bounds under alternate hypothesis</span>
<span class='co'># Always use binding = TRUE for power calculations</span>
<span class='va'>upar</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>xx</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Bound</span><span class='op'>==</span><span class='st'>"Upper"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Z</span>
<span class='fu'><a href='gs_power_npe.html'>gs_power_npe</a></span><span class='op'>(</span>theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span><span class='op'>)</span>, info <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>40</span>,
             binding <span class='op'>=</span> <span class='cn'>TRUE</span>,
             upar <span class='op'>=</span> <span class='va'>upar</span>,
             lpar <span class='op'>=</span> <span class='op'>-</span><span class='va'>upar</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 9</span>
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>        1 Upper  3.71  0.001<span style='text-decoration: underline;'>04</span>      0.1    0.1    40    40    40
#&gt; <span style='color: #BCBCBC;'>2</span>        2 Upper  2.51  0.235        0.2    0.2    80    80    80
#&gt; <span style='color: #BCBCBC;'>3</span>        3 Upper  1.99  0.902        0.3    0.3   120   120   120
#&gt; <span style='color: #BCBCBC;'>4</span>        1 Lower -<span style='color: #BB0000;'>3.71</span>  0.000<span style='text-decoration: underline;'>007</span>04   0.1    0.1    40    40    40
#&gt; <span style='color: #BCBCBC;'>5</span>        2 Lower -<span style='color: #BB0000;'>2.51</span>  0.000<span style='text-decoration: underline;'>015</span>1    0.2    0.2    80    80    80
#&gt; <span style='color: #BCBCBC;'>6</span>        3 Lower -<span style='color: #BB0000;'>1.99</span>  0.000<span style='text-decoration: underline;'>015</span>1    0.3    0.3   120   120   120</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Keaven Anderson. Site built with pkgdown 1.6.1.
  </p>
  <p>Copyright &copy; Merck Sharp & Dohme Corp., a subsidiary of Merck & Co., Inc., Kenilworth, NJ, USA.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


